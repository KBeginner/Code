<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			#parentDiv div{
				width: 100px;height: 50px;background:darkred;margin: 10px 0;
			}
			#parentDiv1 div{
				width: 150px;height: 150px;background:#FF6600;margin: 10px;
				display:inline-block;filter: alpha(opacity:40);opacity: 0.4;border: 5px solid #333;
			}
			#parentDiv2 div{
				width: 150px; height: 150px;background: #375069; display: inline-block;
				margin: 0 20px;color: #fff;text-align: center;line-height: 150px;border: 5px darkred solid;
				filter: alpha(opacity:100);opacity: 1;
			}
		</style>
	</head>
	<body>
		
			
		<!---------------- 多物体运动框架 ------------------>
		<h3>多物体运动框架：所有东西都不能公用，属性与对象绑定。</h3>
		<p style="color: red;">不适应于带border、padding的模块</p>
		<div id="parentDiv">
			<div></div>
			<div></div>
			<div></div>
		</div>
		
		
		<script>
		window.onload=function(){
				var oParentDiv=document.getElementById("parentDiv");
				var aDiv=oParentDiv.getElementsByTagName("div");
				for(var i=0; i<aDiv.length; i++)				//遍历给每个div添加nomouseover()和onmouseout()
				{	
					aDiv[i].timer=null;							//给每个div定义一个定时器
					
					aDiv[i].onmouseover=function()
					{
						multiMove(this, 400);					//鼠标靠近宽度变成400px
					};
					aDiv[i].onmouseout=function()
					{
						multiMove(this, 100);					//鼠标离开宽度变成100px
					};
				}
		};	
			function multiMove(obj, target)						//函数含两个变量，对象和目标值
			{
//				var timer=null;
				clearInterval(obj.timer);						//开始运动前关闭相应定时器
				obj.timer=setInterval(function()
				{
					var speed=(target-obj.offsetWidth)/7;					
					speed=speed>=0?Math.ceil(speed):Math.floor(speed);		//判断速度的正负值
					if(obj.offsetWidth==target)
					{
						clearInterval(obj.timer);
					}
					else
					{
						obj.style.width=obj.offsetWidth+speed+"px";
					}
				},30);
			}
		</script>
		
		<!---------------- 多个淡入淡出 ------------------><hr />
		<h3>多个淡入淡出</h3>
		<div id="parentDiv1">
			<div></div>
			<div></div>
			<div></div>
			<div></div>
		</div>
		
		<script>
			var oParentDiv1=document.getElementById("parentDiv1");
			var aDiv1=oParentDiv1.getElementsByTagName("div");			
			for(var i=0; i<aDiv1.length; i++)
			{
				aDiv1[i].timer=null;					
				aDiv1[i].alpha=40;							//给每个div定义一个alpha
				aDiv1[i].onmouseover=function()
				{				
					multiFade(this, 100);
				};
				aDiv1[i].onmouseout=function()
				{	
					multiFade(this, 40);
				};
			}
			
			function multiFade(obj, target)
			{	
				clearInterval(obj.timer);
				obj.timer=setInterval(function()
				{
					var speed=(target-obj.alpha)/6;
					speed=speed>0?Math.ceil(speed):Math.floor(speed);
					if(obj.alpha==target)
					{
						clearInterval(obj.timer);
					}
					else
					{
						obj.alpha+=speed;
						obj.style.filter="alpha(opacity:" +obj.alpha+")";
						obj.style.opacity=obj.alpha/100;
					}
				},30);					
			}						
		</script>
		
		
		<!---------------- 任意值多物体运动框架 ------------------><hr />
		<h3>任意值多物体运动框架：不直接使用offsetName（有偏差），而是调用函数获取样式</h3>
		<p style="color: red;">万能框架，适应于带border、padding的模块</p>
		<div id="parentDiv2">
			<div>变高</div>
			<div>变宽</div>
			<div>改变字体大小</div>
			<div>改变alpha</div>
		</div>			
		
		<script>			
			
			var oParentDiv2=document.getElementById("parentDiv2");
			var aDiv=oParentDiv2.getElementsByTagName("div");
			for(var i=0; i<aDiv.length; i++)
			{	
				aDiv[i].timer=null;
				aDiv[0].onmouseover=function()				//aDiv[0]变高
				{					
					moveFrame(this,"height",250)
				};
				aDiv[0].onmouseout=function()
				{ 
					moveFrame(this,"height", 150)
				};
				aDiv[1].onmouseover=function()				//aDiv[1]变宽
				{					
					moveFrame(this,"width",250)
				};
				aDiv[1].onmouseout=function()
				{ 
					moveFrame(this,"width", 150)
				};
				aDiv[2].onmouseover=function()				//aDiv[2]字体大小
				{					
					moveFrame(this,"font-size",20)
				};
				aDiv[2].onmouseout=function()
				{ 
					moveFrame(this,"font-size", 15)
				};
				aDiv[3].onmouseover=function()				//aDiv[2]字体大小
				{	
					moveFrame(this,"opacity",30);
				};
				aDiv[3].onmouseout=function()
				{ 
					moveFrame(this,"opacity", 100);
				};
			}
			
			function getStyle(obj, name)						//封装一个函数来获取外部样式
			{
				if(obj.curentStyle){
					return obj.curentStyle[name];
				}
				else
				{
					return getComputedStyle(obj,false)[name];
				}
			};
			function moveFrame(obj,attr,target)
			{
				clearInterval(obj.timer);
				obj.timer=setInterval(function()
				{	
					var cur=0;
					if(attr=="opacity"){
						cur=Math.round(parseFloat(getStyle(obj,attr))*100);	//opacity为小数*100，然后再四舍五入（把小数转成整数）
					}else{
						cur=parseInt(getStyle(obj,attr));				//调用封装函数获取样式，并转化成整数
					}
					
					//计算速度
					var speed=(target-cur)/6;								
					speed=speed>0?Math.ceil(speed):Math.floor(speed);
					if(cur==target)
					{
						clearInterval(obj.timer);
					}
					else
					{	
						if(attr=="opacity"){
							obj.style.filter="alpha("+cur+speed+")";
							obj.style[attr]=(cur+speed)/100;
						}
						else{
							obj.style[attr]=cur+speed+"px";					//改变样式的值
						}						
					}
				},30);
				
			}
			
		</script>
		
		
		
		
	</body>
</html>
