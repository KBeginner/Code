<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>course8-js运动基础</title>
		<style>
			.parentDiv{position: relative;width: auto;height: 150px; margin: 0;padding: 0;}
			#div1{
				width: 100px;height: 100px;background: #1E90FF;position: absolute;top: 40px;
			}
			#div2{
				width: 100px;height: 150px;background: green;position: absolute;left: -108px;
			}
			#div2 span{
				width: 20px;height: 45px;background: red;position: absolute;top: 30px;right: -20px;
			}
			#div3{
				width: 200px;height: 200px;background: yellow;filter: alpha(opacity:30);opacity: 0.3;
			}
			#div4{
				width: 150px;height: 150px;background: red; position: absolute;top: 0;left: 0;
			}
			#div5{
				width: 150px;height: 150px;background: red; position: absolute;top: 0;left: 1000px;
			}
			#div6,.div1{
				width: 1px;height: 170px; background: black;position: absolute;left: 500px;top: -10px;
			}
			#div7{
				width: 1px;height: 170px; background: black;position: absolute;left: 650px;top: -10px;
			}
			#div8{
				width: 150px;height: 150px;background:#375069; position: absolute;right: 0;
			}
		</style>
		
	</head>
	<body>
		
		<!---------------- 运动框架 ------------------>
		<h3>运动框架(匀速运动)：1、开始运动时，关闭已有的定时器；2、把运动和停止隔开(if/else)</h3>
		<div class="parentDiv">
			<button id="btn1" onclick="startMove(500)">启动</button>
			<div id="div1"></div>
			<div class="div1"></div>
		</div>		
		
		<script>
			var oBtn=document.getElementById("btn1");
			var oDiv=document.getElementById("div1");
			var timer;
			var speed=0;
			var left=0;
			function startMove(iTarget)
			{					
				clearInterval(timer);						//开始运动时，关闭已有的定时器，这样不会执行多个定时器，实现匀速运动
				timer=setInterval(function()
				{	
					var speed=0;
					if(oDiv.offsetLeft<iTarget)
					{
						speed=7;
					}
					else{
						speed=-7;
					}
					
					if(Math.abs(oDiv.offsetLeft-iTarget)<=speed)	//当运动到距离目标的值小于或等于速度时，默认到达	
					{
						clearInterval(timer);						
						oDiv.style.left=iTarget+"px";				//并且设置它的left等于目标值（强制等于）
					}
					else{
						oDiv.style.left=oDiv.offsetLeft+speed+"px";		//通过增加offsetLeft来使它运动
					}
					
				},30);			//每隔30ms执行一次定时器		
			};
		</script>
		
		
		<!---------------- 运动框架的应用：侧边栏 ------------------><hr />
		<h3>运动框架的应用(一)：侧边栏--鼠标靠近弹出，鼠标移开缩回</h3>
		<div class="parentDiv">
			<div id="div2">
				<span>分享</span>
			</div>
		</div>
		
		<script>
			var oDiv2=document.getElementById("div2");
			var oSpan=oDiv2.getElementsByTagName("span")[0];
			var timer1;						
			var speed;
			function sideMenu(target)							//一个运动函数
			{
				clearInterval(timer1);
				
				timer1=setInterval(function()					//设置一个定时间，用于运动
				{	
					if(oDiv2.offsetLeft<target){				//判断speed的值
						speed=10;								//向右运动
					}
					else{
						speed=-10;								//向左运动
					}
					
					if(Math.abs(oDiv2.offsetLeft-target)<=speed)
					{
						clearInterval(timer1);					//如果到了终点，则终止定时器
						oDiv2.style.left=target+"px";
					}
					else
					{							
						oDiv2.style.left=oDiv2.offsetLeft+speed+"px";		//否则进行运动
					}
				},30);
			};
			oDiv2.onmouseover=oSpan.onmouseover=function(){				
				sideMenu(-8);									//鼠标靠近
			};
			oDiv2.onmouseout=oSpan.onmouseout=function(){		//鼠标离开
				sideMenu(-108);				
			};
		</script>
		
		
		<!---------------- 运动框架的应用：淡入淡出的图片 ------------------><hr />
		<h3>运动框架的应用(二)：淡入淡出的图片</h3>
		<div id="div3"></div>
		
		<script>
			var oDiv3=document.getElementById("div3");
			var timer;
			var alpha=30;							//定义一个alpha比作filter里的alpha
			function fade(target)
			{
				var speed=0;						//初始化一个速度变量为0
				clearInterval(timer);				
				timer=setInterval(function()
				{
					if(alpha<target)				//实际alpha小于目标值时，增加
					{
						speed=9;
					}
					else
					{
						speed=-9;
					}
					if(alpha==target)				
					{
						clearInterval(timer);		//等于目标值，关闭定时器
					}
					else
					{
						alpha+=speed;
						oDiv3.style.filter="alpha(opacity:"+alpha+")";
						oDiv3.style.opacity=alpha/100;					
					}
				},30);
			};
			
			oDiv3.onmouseover=function()
			{
				fade(100);
			};
			oDiv3.onmouseout=function()
			{
				fade(30);
			}
		</script>
		
		
		<!---------------- Math：给小数取整 ------------------><hr />
		<h3>Math：给小数取整</h3>
		<p>Math.ceil(小数)：向上取整；  Math.floor(小数)：向下取整； Math.round(小数)：四舍五入； Math.abs()：取绝对值</p>
		<input id="txt1" type="text" />
		<button id="btn2">Math.ceil</button>
		<button id="btn3"> Math.floor</button>
		<button id="btn4"> Math.round</button>
		<button id="btn_abs"> Math.abs</button>
		
		<script>
			var oTxt1=document.getElementById("txt1");
			var oBtn2=document.getElementById("btn2");
			var oBtn3=document.getElementById("btn3");
			var oBtn4=document.getElementById("btn4");
			btn2.onclick=function()
			{				
				alert(Math.ceil(oTxt1.value));
			};
			btn3.onclick=function()
			{				
				alert(Math.floor(oTxt1.value));
			};
			btn4.onclick=function()
			{				
				alert(Math.round(oTxt1.value));
			};
			btn_abs.onclick=function()
			{				
				alert(Math.abs(oTxt1.value));
			};
			
		</script>
		
		
		<!---------------- 缓冲运动 ------------------><hr />
		<h3>缓冲运动框架：开始快，后来慢（速度与时间成正比）</h3>
		<input id="btn5" type="button" value="缓冲运动" />
		<div class="parentDiv">
			<div id="div4"></div>
			<div id="div5"></div>
			<div id="div6"></div>
			<div id="div7"></div>
		</div>
		
		<script>
			var oDiv4=document.getElementById("div4");
			var oDiv5=document.getElementById("div5");
			var oBtn5=document.getElementById("btn5");
			var timer;
			oBtn5.onclick=function bufferMotion()
			{
				timer=setInterval(function()
				{	
					if(oDiv4.offsetLeft>=500 && oDiv5.offsetLeft==500)		//对左右两个div进行判断，若到达终点，终止定时器
					{
						clearInterval(timer);
					}
					else
					{				
						var speed1=(500-oDiv4.offsetLeft)/10;				 
						var speed2=(500-oDiv5.offsetLeft)/10;
						speed1=Math.ceil(speed1);							//向上取整速度的值
						speed2=Math.floor(speed2);							//向下取整速度的值
//						speed=speed>0?Math.ceil(speed):Math.floor(speed);	//判断当速度为正时执行Math.ceil()，当速度为负数时执行Math.floor()
						oDiv4.style.left=oDiv4.offsetLeft+speed1+"px";
						oDiv5.style.left=oDiv5.offsetLeft+speed2+"px";
						
						document.title=oDiv4.offsetLeft+"，"+speed1+" || "+oDiv5.offsetLeft+"，"+speed2;		//在title上显示left和速度
					}
				},30);
			};
		</script>
		
		
		<!---------------- 悬浮菜单 ------------------><hr />
		<h3>悬浮菜单</h3>
		<button id="btn6">悬浮</button>
		<div id="div8"></div>
		
		<script>
			var oBtn6=document.getElementById("btn6");
			oBtn6.onclick=function()					//点击触发悬浮菜单
			{				
				window.onscroll=function()				//onscroll滚动事件
				{
					var oDiv8=document.getElementById("div8");
					
					//获取垂直滚动距离
					var scrollTop=document.documentElement.scrollTop || document.body.scrollTop;	
					
					//垂直居中目标高度=(页面的高度-div8的高度)/2+滚动距离；
					topTarget=(document.documentElement.clientHeight-oDiv8.offsetHeight)/2+scrollTop;     
					suspendMenu(parseInt(topTarget));			//调用定时器函数，值取整(除以2后是小数，防抖动)
				};						
			};
			var timer=null;
			function suspendMenu(suspendTarget)
			{	
				var oDiv8=document.getElementById("div8");
				clearInterval(timer);
				timer=setInterval(function()
				{
					var speed=(suspendTarget-oDiv8.offsetTop)/5;
					speed=speed>0?Math.ceil(speed):Math.floor(speed);
					
					if(oDiv8.offsetTop==suspendTarget)
					{
						clearInterval(timer);
					}
					else
					{
						oDiv8.style.top=oDiv8.offsetTop+speed+"px";
					}
				},30);
			};

		</script>
	</body>
</html>
